<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chúc mừng sinh nhật</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" />
  <script src="https://code.jquery.com/jquery-3.7.1.min.js" crossorigin="anonymous"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Arial', sans-serif;
      background: #fff5f8;
    }
    .letter {
      position: relative;
      overflow: hidden;
    }
    .letter__bg {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: 1;
      border: none;
      pointer-events: none;
    }
    .content__letter, .title__letter, .close {
      position: relative;
      z-index: 2;
    }
    .section {
      display: none;
    }
    .section.active {
      display: block;
    }
    .box__letter, .letter__border {
      display: none;
    }
    .overlay-bg {
      background-color: rgba(255,255,255,0.9);
      padding: 20px;
      border-radius: 10px;
      max-width: 800px;
      margin: 0 auto;
      color: #d00;
      font-weight: bold;
      box-shadow: 0 0 20px rgba(0,0,0,0.2);
    }
    .box__account {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 20px;
    }
    .box__account .image img {
      width: 150px;
      border-radius: 50%;
    }
    .box__account .name {
      margin-top: 10px;
      font-size: 18px;
      font-weight: bold;
      display: inline-flex;
      align-items: center;
      gap: 5px;
      white-space: nowrap;
    }
    .text__letter p {
      white-space: normal;
      line-height: 1.6;
      font-size: 18px;
    }
  </style>
</head>
<body>
  <script>
  window.addEventListener("DOMContentLoaded", function () {
    const music = document.getElementById("birthdayMusic");

    const playMusic = () => {
      music.muted = false; // Bỏ mute sau khi bắt đầu phát
      music.play().catch(() => {
        // Nếu bị chặn, phát khi người dùng click bất kỳ
        document.body.addEventListener("click", () => {
          music.muted = false;
          music.play();
        }, { once: true });
      });
    };

    playMusic();
  });
</script>
  <!-- TỰ PHÁT NHẠC -->
  <audio id="birthdayMusic" autoplay loop muted>
  <source src="./audio/cmsn.mp3" type="audio/mpeg">
</audio>

  <!-- PHẦN 1: Chúc mừng sinh nhật -->
  <div id="section1" class="section active">
    <div class="flag__birthday">
      <img src="./images/1.png" alt="" width="350" class="flag__left">
      <img src="./images/1.png" alt="" width="350" class="flag__right">
    </div>
    <div class="content">
      <div class="left">
        <div class="title">
          <h1 class="happy">
            <span style="--t: 4s;">H</span><span style="--t: 4.2s;">a</span><span style="--t: 4.4s;">p</span><span style="--t: 4.6s;">p</span><span style="--t: 4.8s;">y</span>
          </h1>
          <h1 class="birthday">
            <span style="--t: 5s;">B</span><span style="--t: 5.2s;">i</span><span style="--t: 5.4s;">r</span><span style="--t: 5.6s;">t</span><span style="--t: 5.8s;">h</span><span style="--t: 6s;">d</span><span style="--t: 6.2s;">a</span><span style="--t: 6.4s;">y</span>
          </h1>
          <div class="hat"><img src="./images/hat.png" alt="" width="130"></div>
        </div>
        <div class="date__of__birth"><span></span></div>
        <div class="btn">
          <button id="btn__letter">Ấn vào đây nè cậu <i class="fa-regular fa-envelope"></i></button>
        </div>
      </div>
      <div class="right">
        <div class="box__account">
          <div class="image">
            <img src="./images/ha.jpg" alt=""/>
          </div>
          <div class="name">
            <i class="fa-solid fa-heart"></i>
            <span>Nguyễn Minh Nguyên</span>
            <i class="fa-solid fa-heart"></i>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- PHẦN 2: Thư -->
  <div id="section2" class="section">
    <div class="box__letter">
      <div class="letter__border">
        <div class="letter">
          <iframe class="letter__bg" src="https://taoanhdep.com/love/?b=eyJ0IjpbImNow7pjIG3hu6tuZyBzaW5oIG5o4bqtdCBOZ3V5w6puIiwiTmd1ecOqbiBzaW5oIG5o4bqtdCB2dWkgduG6uyIsImNow7pjIG3hu6tuZyBzaW5oIGPhuq11IG5ow6kiLCJzaW5oIG5o4bqtdCB2dWkgduG6uyBuaGEiXX0=" allowfullscreen></iframe>
          <div class="overlay-bg">
            <div class="content__letter">
              <div class="left">
                <img id="heart__letter" src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExYncwejJiejZ5ajNtNzNhd3Z0dXUyYW9vZG9rMHlqbzdsbnBsd2E3NCZlcD12MV9naWZzX3NlYXJjaCZjdD1n/VyB31XTqZNJhFRZNyl/giphy.gif" alt="">
                <img class="heart heart_1" width="5" src="./images/heart.png" alt="">
                <img class="heart heart_2" width="5" src="./images/heart.png" alt="">
                <img class="heart heart_3" width="5" src="./images/heart.png" alt="">
                <img class="heart heart_4" width="5" src="./images/heart.png" alt="">
              </div>
              <div class="right">
                <div class="love__img">
                  <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExbjZ4eGx3anBzMm8zcmpicGI5bnF0aDQybTFqNjNqaDN3empsdXhoMiZlcD12MV9naWZzX3NlYXJjaCZjdD1n/DyQrKMpqkAhNHZ1iWe/giphy.gif" alt="" width="50">
                </div>
                <div class="text__letter">
                  <p></p>
                </div>
                <img id="mewmew" width="50" src="./images/mewmew.gif" alt="">
              </div>
              <div class="title__letter"></div>
              <div class="close"><i class="fa-solid fa-xmark"></i></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const datetxt = "25-06-2009";
    const datatxtletter = `✨ Chúc mừng sinh nhật nha! Chúc bạn tuổi mới thật vui vẻ, luôn cười tươi, học tốt và gặp nhiều điều may mắn. Hy vọng bạn sẽ luôn giữ được sự dễ thương và đáng yêu như bây giờ. Chúc sinh nhật thật hạnh phúc và nhận được thật nhiều quà nha! 🎂🎁💖`;
    const titleLetter = "Gửi Nguyên";

    const dateSpan = document.querySelector(".date__of__birth span");
    let index = 0;
    let finished = false;
    let transitionTimeout;

    function startTransition() {
      document.getElementById("section1").classList.remove("active");
      document.getElementById("section2").classList.add("active");
      showLetter();
    }

    setTimeout(() => {
      const interval = setInterval(() => {
        if (index < datetxt.length) {
          dateSpan.textContent += datetxt[index];
          index++;
        } else {
          clearInterval(interval);
          document.querySelector(".date__of__birth").prepend(document.createElement("i")).className = "fa-solid fa-star";
          document.querySelector(".date__of__birth").appendChild(document.createElement("i")).className = "fa-solid fa-star";
          finished = true;
          transitionTimeout = setTimeout(startTransition, 5000);
        }
      }, 100);
    }, 1000);

    document.getElementById("btn__letter").addEventListener("click", () => {
      if (!finished) clearTimeout(transitionTimeout);
      startTransition();
    });

    function showLetter() {
      const charArrTitle = titleLetter.split('');
      const charArrContent = datatxtletter.split('');
      let currentIndexTitle = 0;
      let currentIndexLetter = 0;

      $(".box__letter").slideDown();
      setTimeout(() => $(".letter__border").slideDown(), 1000);

      setTimeout(() => {
        const intervalTitle = setInterval(() => {
          if (currentIndexTitle < charArrTitle.length) {
            const el = document.querySelector(".title__letter");
            el.textContent += charArrTitle[currentIndexTitle];
            const i = document.createElement("i");
            i.className = "fa-solid fa-heart";
            el.appendChild(i);
            currentIndexTitle++;
          } else {
            clearInterval(intervalTitle);
          }
        }, 100);
      }, 2000);

      setTimeout(() => {
        document.querySelector("#heart__letter").classList.add("animationOp");
        document.querySelector(".love__img").classList.add("animationOp");
        document.querySelector("#mewmew").classList.add("animationOp");
      }, 2800);

      setTimeout(() => {
        document.querySelectorAll(".heart").forEach(item => item.classList.add("animation"));
      }, 3500);

      setTimeout(() => {
        const p = document.querySelector(".text__letter p");
        const intervalContent = setInterval(() => {
          if (currentIndexLetter < charArrContent.length) {
            p.textContent += charArrContent[currentIndexLetter];
            currentIndexLetter++;
          } else {
            clearInterval(intervalContent);
          }
        }, 50);
      }, 6000);
    }
  </script>
</body>
</html>
